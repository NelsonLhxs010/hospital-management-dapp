<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>医院管理系统 | Hospital Management System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
    <style>
        .section {
            display: none;
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        .role-btn {
            margin: 5px;
        }
        .card {
            margin-bottom: 15px;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-md-12 text-center">
                <h1>医院管理系统 | Hospital Management System</h1>
                <p class="text-muted">基于区块链的去中心化医院管理平台 | Blockchain-based Decentralized Hospital Management Platform</p>
                <hr>
            </div>
        </div>

        <!-- 连接钱包 | Connect Wallet -->
        <div class="row mb-4">
            <div class="col-md-12 text-center">
                <div id="wallet-status" class="alert alert-warning">
                    请连接您的钱包以使用系统 | Please connect your wallet to use the system
                </div>
                <button id="connect-wallet" class="btn btn-primary">连接钱包 | Connect Wallet</button>
                <p class="mt-2">当前地址 | Current Address: <span id="current-address">未连接 | Not Connected</span></p>
                <div id="role-status" class="mt-2 hidden">
                    <div class="alert alert-info">
                        您的角色 | Your Role: <span id="user-role">正在检查 | Checking...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- 角色选择 | Role Selection -->
        <div class="row mb-4 hidden" id="role-selection">
            <div class="col-md-12 text-center">
                <h3>选择您的角色 | Select Your Role</h3>
                <button class="btn btn-info role-btn" id="director-btn">院长 | Director</button>
                <button class="btn btn-success role-btn" id="doctor-btn">医生 | Doctor</button>
                <button class="btn btn-warning role-btn" id="patient-btn">患者 | Patient</button>
            </div>
        </div>

        <!-- 主体内容区域 | Main Content Area -->
        <div class="row">
            <div class="col-md-12">
                <!-- 院长部分 | Director Section -->
                <div id="director-section" class="section">
                    <h2>院长管理面板 | Director Management Panel</h2>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">添加医生 | Add Doctor</div>
                                <div class="card-body">
                                    <form id="add-doctor-form">
                                        <div class="mb-3">
                                            <label for="doctor-address" class="form-label">医生地址 | Doctor Address</label>
                                            <input type="text" class="form-control" id="doctor-address" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="doctor-specialty" class="form-label">专业 | Specialty</label>
                                            <input type="text" class="form-control" id="doctor-specialty" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="doctor-working-days" class="form-label">工作日 | Working Days</label>
                                            <input type="text" class="form-control" id="doctor-working-days" placeholder="例如: 周一至周五 | Ex: Monday to Friday" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="doctor-qualification" class="form-label">资质 | Qualification</label>
                                            <input type="text" class="form-control" id="doctor-qualification" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">添加医生 | Add Doctor</button>
                                    </form>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">撤销医生权限 | Revoke Doctor</div>
                                <div class="card-body">
                                    <form id="revoke-doctor-form">
                                        <div class="mb-3">
                                            <label for="revoke-doctor-address" class="form-label">医生地址 | Doctor Address</label>
                                            <input type="text" class="form-control" id="revoke-doctor-address" required>
                                        </div>
                                        <button type="submit" class="btn btn-danger">撤销权限 | Revoke</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">医院统计 | Hospital Statistics</div>
                                <div class="card-body">
                                    <button id="get-stats-btn" class="btn btn-info mb-3">获取统计数据 | Get Statistics</button>
                                    <div id="stats-result" class="alert alert-light">
                                        <p>医生数量 | Doctor Count: <span id="doctor-count">-</span></p>
                                        <p>患者数量 | Patient Count: <span id="patient-count">-</span></p>
                                        <p>预约数量 | Appointment Count: <span id="appointment-count">-</span></p>
                                    </div>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">医生列表 | Doctor List</div>
                                <div class="card-body">
                                    <button id="get-doctors-btn" class="btn btn-info mb-3">获取医生列表 | Get Doctors</button>
                                    <div id="doctor-list" class="list-group">
                                        <!-- 医生列表将在这里动态生成 | Doctor list will be generated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 医生部分 | Doctor Section -->
                <div id="doctor-section" class="section">
                    <h2>医生管理面板 | Doctor Management Panel</h2>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">添加患者 | Add Patient</div>
                                <div class="card-body">
                                    <form id="add-patient-form">
                                        <div class="mb-3">
                                            <label for="patient-address" class="form-label">患者地址 | Patient Address</label>
                                            <input type="text" class="form-control" id="patient-address" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="patient-age" class="form-label">年龄 | Age</label>
                                            <input type="number" class="form-control" id="patient-age" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="patient-gender" class="form-label">性别 | Gender</label>
                                            <select class="form-control" id="patient-gender" required>
                                                <option value="">请选择 | Select</option>
                                                <option value="Male">男 | Male</option>
                                                <option value="Female">女 | Female</option>
                                                <option value="Other">其他 | Other</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary">添加患者 | Add Patient</button>
                                    </form>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">添加药物记录 | Add Medication</div>
                                <div class="card-body">
                                    <form id="add-medication-form">
                                        <div class="mb-3">
                                            <label for="medication-patient-address" class="form-label">患者地址 | Patient Address</label>
                                            <input type="text" class="form-control" id="medication-patient-address" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="medication-record" class="form-label">药物记录 | Medication</label>
                                            <textarea class="form-control" id="medication-record" rows="3" required></textarea>
                                        </div>
                                        <button type="submit" class="btn btn-primary">添加记录 | Add Record</button>
                                    </form>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">设置预约费用 | Set Appointment Fee</div>
                                <div class="card-body">
                                    <form id="set-fee-form">
                                        <div class="mb-3">
                                            <label for="appointment-fee" class="form-label">预约费用 (ETH) | Appointment Fee (ETH)</label>
                                            <input type="number" step="0.001" class="form-control" id="appointment-fee" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">设置费用 | Set Fee</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">我的预约列表 | My Appointments</div>
                                <div class="card-body">
                                    <button id="get-doctor-appointments-btn" class="btn btn-info mb-3">获取预约列表 | Get Appointments</button>
                                    <div id="doctor-appointments" class="list-group">
                                        <!-- 预约列表将在这里动态生成 | Appointments will be generated here -->
                                    </div>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">完成预约 | Complete Appointment</div>
                                <div class="card-body">
                                    <form id="complete-appointment-form">
                                        <div class="mb-3">
                                            <label for="complete-patient-address" class="form-label">患者地址 | Patient Address</label>
                                            <input type="text" class="form-control" id="complete-patient-address" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="appointment-index" class="form-label">预约索引 | Appointment Index</label>
                                            <input type="number" class="form-control" id="appointment-index" required>
                                        </div>
                                        <button type="submit" class="btn btn-success">完成预约 | Complete</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 患者部分 | Patient Section -->
                <div id="patient-section" class="section">
                    <h2>患者服务面板 | Patient Service Panel</h2>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">自我注册 | Self Registration</div>
                                <div class="card-body">
                                    <form id="register-self-form">
                                        <div class="mb-3">
                                            <label for="self-age" class="form-label">年龄 | Age</label>
                                            <input type="number" class="form-control" id="self-age" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="self-gender" class="form-label">性别 | Gender</label>
                                            <select class="form-control" id="self-gender" required>
                                                <option value="">请选择 | Select</option>
                                                <option value="Male">男 | Male</option>
                                                <option value="Female">女 | Female</option>
                                                <option value="Other">其他 | Other</option>
                                            </select>
                                        </div>
                                        <button type="submit" class="btn btn-primary">注册 | Register</button>
                                    </form>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">预约医生 | Book Appointment</div>
                                <div class="card-body">
                                    <form id="book-appointment-form">
                                        <div class="mb-3">
                                            <label for="book-doctor-address" class="form-label">医生地址 | Doctor Address</label>
                                            <input type="text" class="form-control" id="book-doctor-address" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="appointment-date" class="form-label">预约日期时间 | Appointment Date & Time</label>
                                            <input type="datetime-local" class="form-control" id="appointment-date" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="appointment-payment" class="form-label">支付金额 (ETH) | Payment Amount (ETH)</label>
                                            <input type="number" step="0.001" class="form-control" id="appointment-payment" required>
                                        </div>
                                        <button type="submit" class="btn btn-primary">预约 | Book</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">我的医疗记录 | My Medical Records</div>
                                <div class="card-body">
                                    <button id="get-medical-record-btn" class="btn btn-info mb-3">获取医疗记录 | Get Medical Records</button>
                                    <div id="medical-record-result" class="alert alert-light">
                                        <p>年龄 | Age: <span id="record-age">-</span></p>
                                        <p>性别 | Gender: <span id="record-gender">-</span></p>
                                        <p>药物记录 | Medication: <span id="record-medication">-</span></p>
                                    </div>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">我的预约 | My Appointments</div>
                                <div class="card-body">
                                    <button id="get-patient-appointments-btn" class="btn btn-info mb-3">获取预约 | Get Appointments</button>
                                    <div id="patient-appointments" class="list-group">
                                        <!-- 预约列表将在这里动态生成 | Appointments will be generated here -->
                                    </div>
                                </div>
                            </div>

                            <div class="card mt-4">
                                <div class="card-header">可用医生 | Available Doctors</div>
                                <div class="card-body">
                                    <button id="get-available-doctors-btn" class="btn btn-info mb-3">获取医生列表 | Get Available Doctors</button>
                                    <div id="available-doctors" class="list-group">
                                        <!-- 医生列表将在这里动态生成 | Doctor list will be generated here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 通知弹窗 | Notification Modal -->
    <div class="modal fade" id="notification-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="notification-title">通知 | Notification</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="notification-body">
                    消息内容 | Message content
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭 | Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
